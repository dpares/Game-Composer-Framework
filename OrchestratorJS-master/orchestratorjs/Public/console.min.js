function changeActivePage(e){$("ul li.active").removeClass("active");$('ul li a[href="#'+e+'"]').parent().addClass("active")}function showView(e){switch(e){case"actions":showActions();break;case"capabilities":showCapabilities();break;case"instances":showInstances();break;case"devices":showDevices();break;case"download":showDownloads();break;case"develop":showDevelop();break;default:showHome()}}function showActions(){$.getJSON("/api/"+apiVersion+"/action",function(e){require(["text!templates/fileNames.html"],function(t){var n={filenames:e.actions,type:"Action"},r=Mustache.to_html(t,n);r='<div class="row contents"><div class="large-9 columns actionCode"></div>'+r+"</div>";$(".container").html(r);changeActivePage("#actions")})})}function updateActionNames(){$.getJSON("/api/"+apiVersion+"/action",function(e){require(["text!templates/fileNames.html"],function(t){var n=Mustache.to_html(t,{filenames:e.actions,type:"Action"});$(".fileNames").replaceWith(n);var r=$("#fileNameInput").val();$(".fileName_"+r).addClass("active")})})}function showActionCode(e){if(e==""){$(".actionCode").replaceWith('<div class="large-9 columns actionCode"></div>');return}$.ajax({type:"GET",url:"/api/"+apiVersion+"/action/"+e}).done(function(t){require(["text!templates/editActionCode.html"],function(n){var r=Mustache.to_html(n,{code:t,actionName:e});$(".actionCode").replaceWith(r);loadFileToEditor("action");$(".fileNameLink").removeClass("active");$(".fileName_"+e).addClass("active");showParams()})})}function showPreviousParams(e,t){e.checked&&$.getJSON("/api/"+apiVersion+"/action/"+t+"/metadata",function(e){console.log(e);var t=[];for(i in e.args){var n=e.args[i];t.push({id:"p"+i,text:JSON.stringify(n)})}$("input#paramLine").select2("data",t)})}function showParams(){$.getJSON("/api/"+apiVersion+"/devices",function(e){var t=[],n=e.devices;for(i in n){var r=n[i].identity;t.push('"device:'+r+'"')}$("#paramLine").select2({tags:t,separator:"<myseparotor>",tokenSeparators:["<myseparotor>"]});$("#paramLine").on("change",function(){$("#paramLine_val").html($("#paramLine").val())});$("#paramLine").select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){$("#paramLine").select2("onSortStart")},update:function(){$("#paramLine").select2("onSortEnd")}})})}function triggerAction(e){var t=[],n=$("#paramLine").select2("container").children().find(".select2-search-choice").find("div");for(var r=0;r<n.length;r++){var i=n[r],s=$(i).text(),o=JSON.parse(s);t.push(o)}var u={};u.actionName=e;u.parameters=t;$.ajax({type:"POST",url:"/api/"+apiVersion+"/actioninstance",contentType:"application/json",data:JSON.stringify(u)}).done(function(e){alert(e);console.log(e)})}function ensureDeleteAction(){require(["text!templates/deleteActionModal.html"],function(e){var t=$("#fileNameInput").val(),n={actionName:t},r=Mustache.to_html(e,n);$(".generalModalDiv").replaceWith('<div class="generalModalDiv">'+r+"</div>");$("#deleteActionModal").foundation("reveal","open")})}function deleteAction(e){$.ajax({type:"DELETE",url:"/api/"+apiVersion+"/action/"+e}).done(function(e){$("#deleteActionModal").foundation("reveal","close");updateActionNames();showActionCode("")})}function showCapabilities(){$.getJSON("/api/"+apiVersion+"/capability",function(e){require(["text!templates/fileNames.html"],function(t){var n={filenames:e.capabilities,type:"Capability"},r=Mustache.to_html(t,n);r='<div class="row contents"><div class="large-9 columns capabilityCode"></div>'+r+"</div>";$(".container").html(r);changeActivePage("#capabilities")})})}function updateCapabilityNames(){$.getJSON("/api/"+apiVersion+"/capability",function(e){require(["text!templates/fileNames.html"],function(t){var n=Mustache.to_html(t,{filenames:e.capabilities,type:"Capability"});$(".fileNames").replaceWith(n);var r=$("#fileNameInput").val();$(".fileName_"+r).addClass("active")})})}function showCapabilityCode(e){if(e==""){$(".capabilityCode").replaceWith('<div class="large-9 columns capabilityCode"></div>');return}$.ajax({type:"GET",url:"/api/"+apiVersion+"/capability/"+e}).done(function(t){require(["text!templates/editCapabilityCode.html"],function(n){var r=Mustache.to_html(n,{code:t,capabilityName:e});$(".capabilityCode").replaceWith(r);loadFileToEditor("capability");$(".fileNameLink").removeClass("active");$(".fileName_"+e).addClass("active")})})}function ensureDeleteCapability(){require(["text!templates/deleteCapabilityModal.html"],function(e){var t=$("#fileNameInput").val(),n={capabilityName:t},r=Mustache.to_html(e,n);$(".generalModalDiv").replaceWith('<div class="generalModalDiv">'+r+"</div>");$("#deleteCapabilityModal").foundation("reveal","open")})}function deleteCapability(e){$.ajax({type:"DELETE",url:"/api/"+apiVersion+"/capability/"+e}).done(function(e){console.log(e);$("#deleteCapabilityModal").foundation("reveal","close");updateCapabilityNames();showCapabilityCode("")})}function showInstances(){$.getJSON("/api/"+apiVersion+"/actioninstances",function(e){require(["text!templates/actioninstances.html"],function(t){var n=Mustache.to_html(t,e);n='<div class="row contents"><div class="large-12 columns">'+n+"</div></div>";$(".container").html(n)})})}function deleteActionInstance(e){console.log("deleting: "+e);$.ajax({type:"DELETE",url:"/api/"+apiVersion+"/actioninstance/"+e}).done(function(e){console.log(e)})}function showDevices(){$.getJSON("/api/"+apiVersion+"/devices",function(e){require(["text!templates/devices.html"],function(t){var n=Mustache.to_html(t,e);n='<div class="row contents"><div class="large-12 columns">'+n+"</div></div>";$(".container").html(n)})})}function showDownloads(){$.getJSON("/api/"+apiVersion+"/downloads",function(e){console.log(e);require(["text!templates/downloads.html"],function(t){var n=Mustache.to_html(t,e);$(".container").html(n)})})}function showDevelop(){require(["text!templates/developGeneral.html"],function(e){var t={},n=Mustache.to_html(e,t);$(".container").html(n)})}function showHome(){}require.config({baseUrl:"/js",paths:{templates:"/templates"},waitSeconds:15});$(function(){$(".launchActionBtn").click(function(e){var t=e.target.id;$.ajax({type:"POST",url:"/api/"+apiVersion+"/action/"+t}).done(function(e){console.log(e)})})});$(function(){$(".topMenuBtn").click(function(e){var t=$.param.fragment(e.target.href);showView(t)})});